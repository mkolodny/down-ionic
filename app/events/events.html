<ion-view id="events"
          view-title="Rallytap"
          hide-back-button="true"
          can-swipe-back="false">
  <ion-content>
    <ion-refresher pulling-text="Pull to refresh..."
                   on-refresh="events.refresh()"
                   spinner="bubbles">
    </ion-refresher>
    <input id="create-event-prompt"
           readonly
           ng-mousedown="events.createEvent()"
           ontouchstart
           placeholder="What do you want to do?">
    <ion-list>
      <ion-item ng-repeat="item in events.items"
                ng-class="{'item-divider': item.isDivider}">
        <!-- Divider -->
        <div ng-if="item.isDivider">
          <span class="divider-title">{{item.title}}</span>
          <div class="divider-line"></div>
        </div>

        <!-- Event -->
        <div class="saved-event" ng-if="item.savedEvent">
          <h2>
             {{item.savedEvent.event.title}}<span
             ng-if="item.savedEvent.event.place"
             > at {{item.savedEvent.event.place.name}}</span><span
             ng-if="item.savedEvent.event.datetime"
             > &mdash; {{item.savedEvent.event.datetime | date:"EEE, MMM d 'at' h:mm a"}}</span>
          </h2>
          <div class="event-actions">
            <button class="event-action"
                    ng-disabled="events.didUserSaveEvent(item.savedEvent)"
                    ng-mousedown="events.saveEvent(item)"
                    ontouchstart>
              <i class="fa fa-2x"
                 ng-class="{
                   'fa-star': events.didUserSaveEvent(item.savedEvent),
                   'fa-star-o': !events.didUserSaveEvent(item.savedEvent)
                 }"></i>
            </button>
            <span class="event-action-count">{{item.savedEvent.totalNumInterested}}</span>
            <button class="event-action"
                    ng-mousedown="events.viewComments(item.savedEvent.event)"
                    ontouchstart>
              <i class="fa fa-comment-o fa-2x"></i>
            </button>
            <span class="event-action-count">{{item.savedEvent.numComments}}</span>
            <button class="event-action"
                    ng-mousedown="events.viewMoreOptions(item.savedEvent.event)"
                    ontouchstart>
              <i class="fa fa-ellipsis-h fa-2x"></i>
            </button>
          </div>
          <div class="num-interested-friends"
               ng-if="item.savedEvent.numInterestedFriends > 0">
            <i class="fa fa-star"></i> {{item.savedEvent.numInterestedFriends}} friends are interested
          </div>
          <div class="item item-avatar item-button-right"
               ng-if="item.savedEvent.interestedFriends"
               ng-repeat="friend in item.savedEvent.interestedFriends">
            <img class="item-image" ng-src="{{friend.getImageUrl(72)}}">
            <h3>{{friend.name}}</h3>
            <button class="button invite"
                    ng-class="{invited: events.wasInvited(friend, item.savedEvent.event)}"
                    ng-disabled="events.wasInvited(friend, item.savedEvent.event)"
                    ng-mousedown="events.invite(friend, item.savedEvent.event)"
                    >Down?</button>
          </div>
        </div>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-view>
